<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Action Potential Animation</title>
    <script src="d3.js"></script>
    <script src="animation.js"></script>
    <script src="information.js"></script>
</head>

<body style="text-align: center;" style="font-family: sans-serif;">
    <div id="Title" style="font-size: 30px;" style="height: 100px;"></div>
    <div id="VoltageChart"></div>
    <div id="neuron">
        <svg width="150" height="300" id="Stimulate"></svg>
        <svg width="580" height="300" id="neuron" xmlns="http://www.w3.org/2000/svg">
 <!-- Created with Method Draw - http://github.com/duopixel/Method-Draw/ -->
 <!-- Edited for programmatic referenceability and readability-->
 <g>
  <title>The Neuron</title>
  <!--Upper Axon line -->
  <line fill="none" stroke="black" stroke-width="3" x1="140.00196" y1="150.94509" x2="442.66466" y2="149.61177" id="axon" stroke-linejoin="undefined" stroke-linecap="undefined" class="axon"/>
  
  <!-- Lower axon line -->
  <line fill="none" stroke="black" stroke-width="3" x1="138.66864" y1="188.27793" x2="441.33134" y2="186.94461" id="axon" stroke-linejoin="undefined" stroke-linecap="undefined" class="axon"/>
  
  <!-- Top two branches -->
  <path fill="none" stroke="black" stroke-width="3" d="m141.00195,151.61174c-3.99995,-85.33221 -95.33207,-75.33234 -95.33207,-75.33234" id="branch" class="dendrite"/>
  <path fill="none" stroke="black" stroke-width="3" d="m440.99802,150.27843c7.33325,-71.3324 97.33206,-72.66571 96.66537,-72.66571" id="branch" class="terminal"/>
  
  <!-- Bottom two branches -->
  <path fill="none" stroke="black" stroke-width="3" d="m441.66467,261.61029c-3.99994,-85.33221 -95.33209,-75.33234 -95.33209,-75.33234" id="branch" transform="rotate(179.202, 441.665, 223.764)" class="terminal"/>
  <path fill="none" stroke="black" stroke-width="3" d="m43.00325,188.94458c7.38383,-71.3324 98.0033,-72.66571 97.332,-72.66571" id="branch" transform="rotate(-180, 91.6711, 188.945)" class="dendrite"/>
  
  <!-- The Glial Cells -->
  <rect fill="tan" stroke="none" stroke-width="2" x="165" y="143.61185" width="43.33277" height="53.33263" class="glial"/>
  <rect fill="tan" stroke="none" stroke-width="2" x="232.50001" y="143.61185" width="43.33277" height="53.33263" class="glial"/>
  <rect fill="tan" stroke="none" stroke-width="2" x="299" y="144.2785" width="43.33277" height="53.33263" class="glial"/>
  <rect fill="tan" stroke="none" stroke-width="2" x="367.49996" y="143.11185" width="43.33277" height="53.33263" class="glial"/>
  
  <!-- The cloride ions! -->
  <ellipse class="ion" ry="9" rx="9" id="ion_1" cy="105.41667" cx="49.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_1" cy="148.41667" cx="66.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_1" cy="167.41667" cx="39.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_2" cy="173.41667" cx="123.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_2" cy="209.41667" cx="99.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_2" cy="144.41667" cx="114.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_3" cy="120.41667" cx="89.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_3" cy="233.41667" cx="48.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_3" cy="169.41667" cx="95.5" stroke-width="1.5" stroke="none" fill="none"/>
  <ellipse class="ion" ry="9" rx="9" id="ion_3" cy="195.41667" cx="68.5" stroke-width="1.5" stroke="none" fill="none"/>
  
  <!-- Activation Bolts -->
  <path class="hillock" transform="rotate(-107.974, 102.491, 204.941)" id="Activation" d="m98.65102,161.19672l7.23876,24.62727l-2.98447,2.90617l9.11715,21.10031l-2.98447,3.52295l11.27286,35.33092l-19.12019,-27.07822l3.64578,-3.75792l-11.87703,-17.34238l4.25432,-5.36186l-12.54266,-18.18878l13.97994,-15.75847z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="hillock" transform="rotate(-70.5499, 92.491, 168.941)" id="Activation" d="m88.65102,125.19672l7.23876,24.62727l-2.98447,2.90617l9.11715,21.10031l-2.98447,3.52295l11.27286,35.33092l-19.12019,-27.07822l3.64578,-3.75792l-11.87703,-17.34238l4.25432,-5.36186l-12.54266,-18.18878l13.97994,-15.75847z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="hillock" transform="rotate(-37.8699, 99.991, 135.441)" id="Activation" d="m96.14627,90.98996l7.24773,25.02517l-2.98817,2.95313l9.12845,21.44124l-2.98817,3.57986l11.28682,35.90175l-19.14388,-27.51572l3.6503,-3.81863l-11.89174,-17.62257l4.25958,-5.44849l-12.55819,-18.48267l13.99726,-16.01308z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  
  <!--Sodium Gated Channel Bolt-->
  <path class="channel" transform="rotate(-131.926, 211.991, 217.941)" id="l_bolt" d="m209.72873,195.94141l4.26529,12.38574l-1.75854,1.46161l5.3721,10.61194l-1.75854,1.77179l6.6423,17.76892l-11.26617,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50677,-2.69662l-7.3905,-9.14764l8.2374,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="channel" id="l_bolt" d="m210.72873,101.94141l4.2653,12.38574l-1.75854,1.46161l5.37209,10.61194l-1.75854,1.77179l6.64229,17.76892l-11.26616,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50676,-2.69662l-7.3905,-9.14764l8.23741,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="channel" transform="rotate(-131.926, 278.991, 216.941)" id="m_bolt" d="m276.72873,194.94141l4.26529,12.38574l-1.75854,1.46161l5.3721,10.61194l-1.75854,1.77179l6.6423,17.76892l-11.26617,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50677,-2.69662l-7.3905,-9.14764l8.2374,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="channel" id="m_bolt" d="m274.72873,98.94141l4.26529,12.38574l-1.75854,1.46161l5.3721,10.61194l-1.75854,1.77179l6.6423,17.76892l-11.26617,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50677,-2.69662l-7.3905,-9.14764l8.2374,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="channel" transform="rotate(-131.926, 342.991, 217.941)" id="r_bolt" d="m340.72873,195.94141l4.26529,12.38574l-1.75854,1.46161l5.3721,10.61194l-1.75854,1.77179l6.6423,17.76892l-11.26617,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50677,-2.69662l-7.3905,-9.14764l8.2374,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="channel" id="r_bolt" d="m338.72873,99.94141l4.26529,12.38574l-1.75854,1.46161l5.3721,10.61194l-1.75854,1.77179l6.6423,17.76892l-11.26617,-13.61841l2.14819,-1.88995l-6.99829,-8.72198l2.50677,-2.69662l-7.3905,-9.14764l8.2374,-7.92538z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  
  <!-- directional arrows -->
  <path class="fire" id="arrow_1" d="m158.26169,169.8407l-7.46346,-6.74989l0,3.37419l-8.01198,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01198,0l0,3.37498l7.46346,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_2" d="m191.26135,170.3407l-7.46346,-6.74989l0,3.37419l-8.01198,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01198,0l0,3.37498l7.46346,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_3" d="m225.261,170.34068l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_4" d="m258.76068,169.3407l-7.46342,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49977,0l0,26.99974l-21.49977,0l0,-10.12489l8.01199,0l0,3.37498l7.46342,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_5" d="m292.26035,169.8407l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_6" d="m325.26004,170.34068l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_7" d="m359.2597,169.84068l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_8" d="m393.2594,168.8407l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  <path class="fire" id="arrow_9" d="m429.25903,168.84071l-7.46344,-6.74989l0,3.37419l-8.01199,0l0,-10.12419l21.49979,0l0,26.99974l-21.49979,0l0,-10.12489l8.01199,0l0,3.37498l7.46344,-6.74994l0,0z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
  
  <!-- The Big Arrow -->
  <path class="cascade" id="Signal" d="m469.43311,114.05076l47.62506,0l15.87433,53.49677l-15.87433,53.50218l-47.62506,0l15.87503,-53.50218l-15.87503,-53.49677z" fill-opacity="null" stroke-opacity="null" stroke-width="1.5" stroke="none" fill="none"/>
 </g>
</svg>
        <svg width="150" height="300" id="Reveal"></svg>
    </div>
    <div id="TextExplain" style="font-size: 24px;" style="top-padding: 100px;"></div>


    <script type="text/javascript">
        d3.json("voltages2.json", function(error, json) {
    if (error) {return console.warn(error)};
    data = json;
    draw(data);
    });
    
    function draw(data){
    
    d3.select("#Title")
        .text("Voltage Levels in the Axon Hillock during A Neuron Fire")
        .style("text-anchor", "end")
        .style("fill", "black");
    
    
    // set default explanatory text
    d3.select("#TextExplain")
        .attr("height", "100px")
        .text("Diagram of a Neuron");
    
    d3.selectAll(".axon")
        .on("click", function(){
            d3.select("#TextExplain")
                .text("This is the axon body. When the neuron fires, the signal travels along the length of the Axon body.");
        });
    d3.selectAll(".dendrite")
        .on("click", function(){
            d3.select("#TextExplain")
                .text("A neuron receives signals through a series of branching, tree-like structures called Dendrites. These are stimulated by neurotransmitters - such as Dopamine, Oxytocin and Serotonin - and funnel that stimulation to the Axon Hillock, shown here.");
        });
    d3.selectAll(".terminal")
        .on("click", function(){
            d3.select("#TextExplain")
                .text("After a signal is sent, it triggers the release of neurotransmitters through another series of branching structures called Terminal Buttons. These form joints, or synapses, with the dendrites of other neurons.");
        });
    
    d3.selectAll(".glial")
            .on("click", function() {
                // no time - undo
                // update text
                d3.select("#TextExplain")
                    .text("Along the axon body, smaller cells called Schwann cells wrap around the axon. These myelin sheaths provide structural support to the neuron and insulate the axon, allowing signals to travel farther.");});
        
    
    var padding = 30;
    
    // initialize axes scales
    var yScale = d3.scale.linear()
                        .domain([-95, 45])
                        .range([350, 10]);
        
    var xScale = d3.scale.linear()
                    .domain([0, 5])
                    .range([155, 630]);
       
       
    // initialize axes themselves
    var xAxis = d3.svg.axis()
                  .scale(xScale)
                  .orient("bottom")
                  .ticks(10); 
    
    var yAxis = d3.svg.axis()
                  .scale(yScale)
                  .orient("left")
                  .ticks(5, "mV"); 
    
    // create a scatterchart to display Voltage vs. Time
    var VoltageSVG = d3.select("#VoltageChart")
                    .append("svg")
                    .attr("width", 830)
                    .attr("height", 425);
        
    VoltageSVG.selectAll("circle")
            .data(data.points)
            .enter()
            .append("circle")
            .attr("class", "point")
            .attr("id", function(d, i) {return "Time_" + i;})
            .attr("cx", function(d, i){return xScale(d.Time);})
            .attr("cy", function(d){return yScale(d.Voltage);})
            .attr("r", 7)
            .attr("fill", "lightblue")
            .append("title")
            .text(function(d){
                return "Time: " + d.Time + " mS, Voltage: " + d.Voltage + " mV";
            })
            ;
    
    VoltageSVG.selectAll("text")
            .data(data.points)
            .enter()
            .append("text")
            .attr("id", function(d, i) {return "Time_" + i;})
            .attr("class", "point")
            .text(function(d){
                return d.Voltage;
            })
            .attr("x", function(d, i){return xScale(d.Time) + 7;})
            .attr("y", function(d){return yScale(d.Voltage) + 5;})
            .attr("font-size", "11px")
            .attr("fill", "lightblue");
    
    VoltageSVG.selectAll("line")
            .data(data.lines)
            .enter()
            .append("line")
            .attr("id", function(d, i){ return "n_" + i ;})
            .attr("x1", function(d){return xScale(-0.25)})
            .attr("x2", function(d){return xScale(5.1)})
            .attr("y1", function(d){return yScale(d.value)})
            .attr("y2", function(d){return yScale(d.value)})
            .attr("stroke", "none");
            
    VoltageSVG.selectAll("text.lines")
            .data(data.lines)
            .enter()
            .append("text")
            .attr("class", "lines")
            .text(function(d){return d.state;})
            .attr("id", function(d, i){ return "n_" + i ;})
            .attr("x", function(d){return xScale(5.6);})
            .attr("y", function(d){return yScale(d.value) + 5;})
            .attr("font-size", "18px")
            .attr("fill", "none");
        
    
    VoltageSVG.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(0," + (yScale(-100)) + ")")
            .attr("shape-rendering", "crispEdges")
            .call(xAxis)
        .append("text")
            .attr("y", 50)
            .attr("x", function(d){return xScale(3);})
            .style("text-anchor", "end")
            .text("Time (mS)");
    
    VoltageSVG.append("g")
            .attr("class", "axis")
            .attr("transform", "translate(" + (xScale(-0.25)) + ",0)")
            .attr("shape-rendering", "crispEdges")
            .call(yAxis)
        .append("text")
            .attr("y", function(d){return yScale(-25);})
            .attr("x", -40)
            .style("text-anchor", "end")
            .text("Voltage (mV)");
    
    
    // buttons for clicking!
    d3.select("#Stimulate")
        .append("rect")
        .attr("fill", "lightblue")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", 150)
        .attr("height", 300);
    d3.select("#Stimulate").append("text")
        .text("Click to Stimulate!")
        .attr("x", 15)
        .attr("y", 150);
    
    d3.select("#Reveal")
        .append("rect")
        .attr("fill", "plum")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", 150)
        .attr("height", 300);
    d3.select("#Reveal").append("text")
        .text("Click to Learn!")
        .attr("x", 30)
        .attr("y", 150);
    
    
    // ability to click on chart for closer look
    d3.selectAll("circle.point")
            .on("click", function(d) {
                console.log(this.id);
                // adjust for size
                d3.selectAll("text#"+this.id)
                    .transition()
                    .ease("bounce")
                    .attr("font-size", "18px")
                    .attr("fill", "red")
                    .attr("x", function(d, i){return xScale(d.Time) + 25;})
                    .attr("y", function(d){return yScale(d.Voltage) + 5;});
                // make it bigger
                d3.selectAll("circle#"+this.id)
                    .transition()
                    .ease("bounce")
                    .attr("fill", "red")
                    .attr("r", 20);
                    
                
                // return to normal
                d3.selectAll("circle#"+this.id)
                    .transition()
                    .delay(2500)
                    .ease("elastic")
                    .attr("fill", "lightblue")
                    .attr("r", 7);
                // return to normal
                d3.selectAll("text#"+this.id)
                    .transition()
                    .delay(2500)
                    .ease("elastic")
                    .attr("font-size", "11px")
                    .attr("fill", "lightblue")
                    .attr("x", function(d, i){return xScale(d.Time) + 7;})
                    .attr("y", function(d){return yScale(d.Voltage) + 5;});
                
                
                switch (this.id){
                
                case "Time_0":
                    d3.selectAll("#n_0")
                        .transition()
                        .attr("fill", "red")
                        .attr("stroke", "red");
                    
                    d3.selectAll("#n_0")
                        .transition()
                        .delay(2500)
                        .ease("elastic")
                        .attr("fill", "none")
                        .attr("stroke", "none");
                    break;
                
                case "Time_1":
                    d3.selectAll("#n_0")
                        .transition()
                        .attr("fill", "red")
                        .attr("stroke", "red");
                    
                    d3.selectAll("#n_0")
                        .transition()
                        .delay(2500)
                        .ease("elastic")
                        .attr("fill", "none")
                        .attr("stroke", "none");
                    break;
                    
                case "Time_2":
                    d3.selectAll("#n_1")
                        .transition()
                        .attr("fill", "red")
                        .attr("stroke", "red");
                    
                    d3.selectAll("#n_1")
                        .transition()
                        .delay(2500)
                        .ease("elastic")
                        .attr("fill", "none")
                        .attr("stroke", "none");
                    break;
                
                case "Time_3":
                    d3.selectAll("#n_2")
                        .transition()
                        .attr("fill", "red")
                        .attr("stroke", "red");
                    
                    d3.selectAll("#n_2")
                        .transition()
                        .delay(2500)
                        .ease("elastic")
                        .attr("fill", "none")
                        .attr("stroke", "none");
                    break;
                    
                case "Time_6":
                    d3.selectAll("#n_3")
                        .transition()
                        .attr("fill", "red")
                        .attr("stroke", "red");
                    
                    d3.selectAll("#n_3")
                        .transition()
                        .delay(2500)
                        .ease("elastic")
                        .attr("fill", "none")
                        .attr("stroke", "none");
                    break;
                }
                
                });
    
    
    
    d3.selectAll("#Stimulate")
        .on("click", function(){
            Animate(xScale, yScale);
            });
    
    var clicks = 0;
    d3.selectAll("#Reveal")
        .on("click", function(){
            clicks = clicks + 1;
            if (clicks === 2) {
                clicks = 0;
            }
            console.log(clicks);
            inform(clicks);
        })
        
    
    }
    </script>

</body>
